__global__ void UpdateFibers(...)
{
  int i = blockIdx.x * blockDim.x + threadIdx.x;

  if (i >= NUMBER_OF_FIBERS) return;

  next_positions[i] = 4/3 * current_positions[i]
    - 1/3 * previous_positions[i]
    + 2/3 * TIMESTEP
    * (2 * current_translational_velocities[i]
      - previous_translational_velocities[i]))

  next_orientations[i] = 4/3 * current_orientations[i]
    - 1/3 * previous_orientations[i]
    + 2/3 * TIMESTEP
    * (2 * current_rotational_velocities[i]
      - current_rotational_velocities[i]))

  normalize(next_orientations)
}
